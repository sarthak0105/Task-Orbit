<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="Teams.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <title>Teams</title>
</head>
<body>
    <div class="container">
        
        <aside class="sidebar">
            
            <div class="logo"></div>
            <img src="public/whatsapp-image-20240818-at-83859-amremovebgpreview-2@2x.png" alt="logo" class="logo">
            <nav>
                <ul>
                    <li><span class="material-symbols-outlined">home</span><a href="Home_page.html">Home</a></li>
                    <li><span class="material-symbols-outlined">paid</span><a href="Finances.html">Finances</a></li>        
                    <li><span class="material-symbols-outlined">groups</span><a href="Teams.html">Teams</a></li>
                    <li><span class="material-symbols-outlined">account_circle</span><a href="profile.html">Profile</a></li>
                    <li><span class="material-symbols-outlined">info</span><a href="About_Us.html">About us</a></li>
                </ul>
            </nav>
        </aside>
        <!-- Right Column for Upcoming Tasks -->
        <div class="right-column">
            <div class="top-right-icons">
                <a href="#"><i class="fas fa-bell"></i></a>
                <a href="#"><i class="fas fa-cog"></i></a>
                <a href="#"><i class="fas fa-right-from-bracket" id="logoutIcon"></i></a>
                 <a href="#"><i id="theme-toggle" class="fas fa-moon" class="fas fa-moon"></i></a>
            </div>

            <h2 class="head">Teams</h2>
            <div class="teams-container">
                
                <div class="team-item">
                    <div class="team-icon">
                        <span class="material-symbols-outlined">app_registration </span>     
                    </div>  
                       
                    <a href="team_page.html?team=Registrations%20%26%20Campus%20Campaigning" class="team-name"><span class="team-name">Registrations & Campus Campaigning</span></a>
                </div>
                <div class="team-item">
                    <div class="team-icon">
                        <span class="material-symbols-outlined">perm_media</span>
                    </div>
                    <a href="team_page.html?team=Media%20Content%20%26%20Blog" class="team-name"><span class="team-name">Media Content & Blog</span></a>
                </div>
                <div class="team-item">
                    <div class="team-icon">
                        <span class="material-symbols-outlined">currency_rupee_circle</span>
                    </div>
                   <a href="team_page.html?team=Sponsorship" class="team-name"><span class="team-name">Sponsorship</span></a>
                </div>
                <div class="team-item">
                    <div class="team-icon">
                        <span class="material-symbols-outlined">local_shipping</span>
                    </div>
                   <a href="team_page.html?team=Logistics" class="team-name"><span class="team-name">Logistics</span></a>
                </div>
                <div class="team-item">
                    <div class="team-icon">
                        <span class="material-symbols-outlined">dvr</span>
                    </div>
                   <a href="team_page.html?team=Technical" class="team-name"><span class="team-name">Technical</span></a>
                </div>
            </div>
  <h3>Leaderboard</h3>
            <div class="leaderboard-container">
  
    <div id="leaderboard-list"></div> <!-- Empty container for leaderboard items -->
</div>

            <div class="announcements-container">
    <h4>Announcements</h4>
    <div id="announcements-list"></div>
</div>
            
  <div class="progress-card">
  <h1>Total Progress Grade</h1>
  <div class="progress-content">
    <p id="progress-description">Every task is being performed effectively by all the teams and all the deadlines are followed.</p>
    <div class="progress-circle">
      <canvas id="progressCanvas" width="100" height="100"></canvas>
    </div>
  </div>
</div>

			</div>
	

			<script>







async function fetchAnnouncements() {
        try {
            const response = await fetch('/get-announcements');
            const data = await response.json();
            const announcementList = document.getElementById('announcements-list');
            announcementList.innerHTML = ''; // Clear previous announcements

            data.announcements.forEach(({ text, time }) => {
                const announcement = document.createElement('div');
                announcement.classList.add('announcement');
                announcement.innerHTML = `
                    <div class="time">${new Date(time).toLocaleTimeString()}</div>
                    <div class="announcement-details">${text}</div>
                `;
                announcementList.appendChild(announcement);
            });
        } catch (error) {
            console.error('Error fetching announcements:', error);
        }
    }

    // Call this function on page load
    document.addEventListener('DOMContentLoaded', fetchAnnouncements);






				// Theme toggle functionality
        const themeToggleButton = document.getElementById('theme-toggle');
        const currentTheme = localStorage.getItem('theme') || 'light';

        // Apply the saved theme on page load
        document.body.classList.add(currentTheme);

        themeToggleButton.addEventListener('click', () => {
            if (document.body.classList.contains('light')) {
                document.body.classList.remove('light');
                document.body.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                themeToggleButton.classList.replace('fa-moon', 'fa-sun'); // Change icon to sun
            } else {
                document.body.classList.remove('dark');
                document.body.classList.add('light');
                localStorage.setItem('theme', 'light');
                themeToggleButton.classList.replace('fa-sun', 'fa-moon'); // Change icon to moon
            }
        });

        // Set the initial icon based on the saved theme
        themeToggleButton.classList.add(currentTheme === 'light' ? 'fa-moon' : 'fa-sun');

		  // Logout functionality when clicking the logout icon
      document.getElementById('logoutIcon').addEventListener('click', function () {
        // Optionally, clear session or localStorage data
        // localStorage.removeItem('userToken'); // Example if you're using localStorage
        
        // Redirect to the login page
        window.location.href = 'login-page.html';
      });


		async function fetchAndDisplayLeaderboard() {
  try {
    const response = await fetch('/leaderboard-display');
    if (!response.ok) throw new Error('Failed to fetch leaderboard');
    
    const leaderboardData = await response.json();

    const leaderboardList = document.getElementById('leaderboard-list');
    leaderboardList.innerHTML = ''; // Clear previous leaderboard

    leaderboardData.forEach((user, index) => {
      const leaderItem = document.createElement('div');
      leaderItem.classList.add('leader-item');

      // Create elements for rank, name, and progress percentage
      const rankBadge = document.createElement('div');
      rankBadge.classList.add('rank-badge');
      rankBadge.innerText = index + 1; // Rank based on position in sorted list

      const nameSpan = document.createElement('span');
      nameSpan.classList.add('leader-name');
      nameSpan.innerText = user.name;

      const progressBadge = document.createElement('div');
      progressBadge.classList.add('progress-badge');
      progressBadge.innerText = `${user.progress}%`;

      // Append elements to the leaderboard item
      leaderItem.appendChild(rankBadge);
      leaderItem.appendChild(nameSpan);
      leaderItem.appendChild(progressBadge);

      // Append the leader item to the leaderboard list
      leaderboardList.appendChild(leaderItem);
    });
  } catch (error) {
    console.error('Error displaying leaderboard:', error);
  }
}

// Call this function on page load to display the leaderboard
document.addEventListener('DOMContentLoaded', fetchAndDisplayLeaderboard);




				</script>
				<script src="Team.js"></script>
</body>
</html>