<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="Admin.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>Admin</title>
</head>

<body>
    
    <div class="container">
            
        <aside class="sidebar">
            
            <div class="logo"></div>
            <img alt="logo" src="public/whatsapp-image-20240818-at-83859-amremovebgpreview-2@2x.png" class="logo">
            <nav>
                <ul>
                   <li><span class="material-symbols-outlined">home</span><a href="Admin.html">Home</a></li>
                    <li><span class="material-symbols-outlined">task_alt</span><a href="task_allocation.html">Tasks</a></li>        
                    <li><span class="material-symbols-outlined">monitoring</span><a href="progress page.html">Performace</a></li>
						  <li><span class="material-symbols-outlined">assured_workload</span><a href="Budget Allocation.html">Budget</a></li>
                    <li><span class="material-symbols-outlined">person_add</span><a href="Add_User.html">Add User</a></li>
                    <li><span class="material-symbols-outlined">info</span><a href="About_Us_admin.html">About us</a></li>
                </ul>
            </nav>
        </aside>
        </div>
        
    
        <div class="right-column">
            <div class="top-right-icons">
                <a href="#"><i class="fas fa-bell"></i></a>
                <a href="#"><i class="fas fa-cog"></i></a>
                <a href="#"><i class="fas fa-right-from-bracket" id="logoutIcon"></i></a>
                <a href="#"><i id="theme-toggle" class="fas fa-moon" class="fas fa-moon"></i></a>
            </div>
           <!-- Event Information Section -->
        <p class="Eventhead">Event Information</p>
        <div class="event-container">
    
    <label  for="event-name">Event Name:</label>
    <input type="text" id="event-name" placeholder="Enter event name" />
    <br>
    <label  for="event-date">Date:</label>
    <input type="date" id="event-date" />
    <br>
    <label  for="event-location">Location:</label>
    <input type="text" id="event-location" placeholder="Enter location" />
    <br>
    <label  for="event-description">Description:</label>
    <textarea id="event-description" placeholder="Enter description"></textarea>
    <br>
    <button class="Eventinfo" onclick="saveEventInfo()">Save Event Information</button>
</div>

<h3>Leaderboard</h3>
        <div class="leaderboard-container">
    <div id="leaderboard-list"></div> <!-- Empty container for leaderboard items -->
</div>
        <div class="map-section">
            <div class="section-title map-title">Event Location</div>
            <div class="map-container">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3821.6753176908583!2d74.23982587451061!3d16.693123222435375!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3bc1003c1a127f07%3A0x46fe34fd32993356!2s9th%20Ln%2C%20Kolhapur%2C%20Maharashtra!5e0!3m2!1sen!2sin!4v1728973735467!5m2!1sen!2sin" width="1090" height="200" style="border: 9px;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>
    </div>
    <p class="budget-overview">Budget Overview</p>
    <div class="budget-overview"></div>
<div class="budget-container">
    <!-- Input for Total Budget -->
    

    <!-- Budget Chart Display -->
    <div class="budget-chart-container">
        <div class="pie-chart" id="budget-chart">
            <span class="percentage-text" id="percentage">0%</span>
        </div>
    </div>

   <div class="budget-input">
        <label for="total-budget">Enter Total Budget: </label>
        <input type="number" id="total-budget" placeholder="Enter budget amount">
        <button onclick="submitBudget()">Set Budget</button>
    </div>
	 <br> <br>
 <!-- Allocated Budget Display -->
    <div class="allocated-budget-display">
        <label for="allocated-budget">Allocated Budget: </label>
        <span id="allocated-budget">0</span>
    </div>
<br><br>
    <!-- Remaining Budget Display -->
    <div class="remaining-budget-display">
        <label for="remaining-budget">Remaining Budget: </label>
        <span id="remaining-budget">0</span>
    </div>


	 </div>

	 <script>



async function saveEventInfo() {
    const adminData = {
        eventname: document.getElementById('event-name').value,
        date: document.getElementById('event-date').value,
        location: document.getElementById('event-location').value,
        description: document.getElementById('event-description').value,
    };

    try {
        const response = await fetch('/save-event', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(adminData),
        });

        if (response.ok) {
            alert("Event information saved successfully!");
        } else {
            throw new Error("Failed to save event information.");
        }
    } catch (error) {
        console.error("Error saving event information:", error);
    }
}

// Load event information on page load
document.addEventListener('DOMContentLoaded', loadEventInfo);

async function loadEventInfo() {
    try {
        const response = await fetch('/get-event');
        if (!response.ok) throw new Error("Failed to fetch event information.");

        const adminData = await response.json();
        document.getElementById('event-name').value = adminData.eventname || '';
        document.getElementById('event-date').value = adminData.date || '';
        document.getElementById('event-location').value = adminData.location || '';
        document.getElementById('event-description').value = adminData.description || '';
    } catch (error) {
        console.error("Error loading event information:", error);
    }
}



	 // Theme toggle functionality
        const themeToggleButton = document.getElementById('theme-toggle');
        const currentTheme = localStorage.getItem('theme') || 'light';

        // Apply the saved theme on page load
        document.body.classList.add(currentTheme);

        themeToggleButton.addEventListener('click', () => {
            if (document.body.classList.contains('light')) {
                document.body.classList.remove('light');
                document.body.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                themeToggleButton.classList.replace('fa-moon', 'fa-sun'); // Change icon to sun
            } else {
                document.body.classList.remove('dark');
                document.body.classList.add('light');
                localStorage.setItem('theme', 'light');
                themeToggleButton.classList.replace('fa-sun', 'fa-moon'); // Change icon to moon
            }
        });

        // Set the initial icon based on the saved theme
        themeToggleButton.classList.add(currentTheme === 'light' ? 'fa-moon' : 'fa-sun');


      // Logout functionality when clicking the logout icon
      document.getElementById('logoutIcon').addEventListener('click', function () {
        // Optionally, clear session or localStorage data
        // localStorage.removeItem('userToken'); // Example if you're using localStorage
        
        // Redirect to the login page
        window.location.href = 'login-page.html';
      });






async function fetchAndDisplayLeaderboard() {
  try {
    const response = await fetch('/leaderboard');
    if (!response.ok) throw new Error('Failed to fetch leaderboard');
    
    const leaderboardData = await response.json();
    const leaderboardList = document.getElementById('leaderboard-list');
    leaderboardList.innerHTML = ''; // Clear previous leaderboard

    leaderboardData.forEach(team => {
      // Create a team header
      const teamHeader = document.createElement('h4');
      teamHeader.innerText = `Team: ${team.team}`;
      leaderboardList.appendChild(teamHeader);

      // List members of the team
      team.members.forEach(member => {
        const leaderItem = document.createElement('div');
        leaderItem.classList.add('leader-item');

        const rankBadge = document.createElement('div');
        rankBadge.classList.add('rank-badge');
        rankBadge.innerText = `${member.rank}`;


   const nameSpan = document.createElement('span');
      nameSpan.classList.add('leader-name');
      nameSpan.innerText = member.name;

      // Redirect to User_view.html on name click with user's name as query parameter
      nameSpan.addEventListener('click', () => {
        window.location.href = `User_view.html?username=${encodeURIComponent(member.name)}`;
      });

        const progressBadge = document.createElement('div');
        progressBadge.classList.add('progress-badge');
        progressBadge.innerText = `${member.progress}%`;

        leaderItem.appendChild(rankBadge);
        leaderItem.appendChild(nameSpan);
        leaderItem.appendChild(progressBadge);
        leaderboardList.appendChild(leaderItem);
      });
    });
  } catch (error) {
    console.error('Error displaying leaderboard:', error);
  }
}

document.addEventListener('DOMContentLoaded', fetchAndDisplayLeaderboard);





	 
	 </script>
    <script src="Admin.js"></script>
</body>
</html>